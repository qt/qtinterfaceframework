{
    "module": "interfaceframework",
    "testDir": "../../config.tests",

    "commandline": {
        "options": {
            "ifcodegen": { "type": "enum", "values": [ "no", "qt", "system" ] },
            "qface": { "type": "enum", "values": [ "no", "qt", "system" ] },
            "host-tools-only": "boolean",
            "force-ifcodegen-qtremoteobjects": "boolean"
        }
    },

    "tests": {
        "python3": {
            "label": "Python3",
            "type": "python3",
            "files": [ "python3" ]
        },
        "venv": {
            "label": "venv",
            "type": "python3_package",
            "package": "ensurepip"
        },
        "qface": {
            "label": "qface 2.0.3",
            "type": "python3_package",
            "package": "qface",
            "version": "2.0.3"
        },
        "qface-submodule": {
            "label": "qface-submodule",
            "type": "qface_submodule"
        }
    },

    "features": {
        "python3": {
            "label": "python3",
            "condition": "tests.python3",
            "output": [
                "privateFeature",
                { "type": "varAssign", "public": true, "name": "QMAKE_PYTHON3_LOCATION", "value": "tests.python3.value" },
                { "type": "varAssign", "public": true, "name": "QMAKE_PYTHON3_VERSION", "value": "tests.python3.version" }
            ]
        },
        "python3-venv": {
            "label": "venv",
            "condition": "features.python3 && tests.venv",
            "output": [ "privateFeature" ]
        },
        "system-qface": {
            "label": "System QFace",
            "enable": "input.qface == 'system'",
            "disable": "input.qface == 'no' || input.qface == 'qt'",
            "condition": "tests.qface",
            "output": [ "publicFeature" ]
        },
        "system-ifcodegen": {
            "label": "System Interface Framework Generator",
            "enable": "input.ifcodegen == 'system'",
            "disable": "input.ifcodegen != 'system'",
            "output": [ "privateFeature" ]
        },
        "ifcodegen": {
            "label": "Interface Framework Generator",
            "enable": "input.ifcodegen == 'qt' || input.ifcodegen == 'system'",
            "disable": "input.ifcodegen == 'no'",
            "condition": "features.interfaceframework && features.python3 && ((features.python3-venv && tests.qface-submodule) || (features.system-qface)) || features.system-ifcodegen",
            "output": [ "publicFeature" ]
        },
        "host-tools-only": {
            "label": "Only build the host tools",
            "condition": "input.host-tools-only == 'yes'",
            "output": [ "privateFeature" ]
        },
        "remoteobjects": {
            "label": "QtRemoteObjects Support",
            "condition": "module.remoteobjects || input.force-ifcodegen-qtremoteobjects == 'yes'",
            "output": [ "publicFeature" ]
        },
        "interfaceframework": {
            "label": "Qt Interface Framework Core",
            "output": [ "publicFeature" ]
        }
     },

    "report": [
        {
            "type": "error",
            "condition": "features.interfaceframework && !features.ifcodegen && input.ifcodegen != 'no'",
            "message": "Cannot build the Interface Framework Generator because its dependencies are not satisfied.
The Interface Framework Generator provides tooling to generate source code out of IDL files.
Make sure python3 and its 'venv' packages are installed.
E.g. by running
    apt-get install python3 python3-venv

And make sure the qface submodule is initialized or the correct qface version is installed on your system.
E.g. by running the following command:
    git submodule init && git submodule update"
        },
        {
            "type": "warning",
            "condition": "!features.remoteobjects",
            "message": "Cannot enable the QtRemoteObjects features because the QtRemoteObjects module is not installed."
        }
    ],

    "summary": [
        {
            "section": "Qt Interface Framework Core",
            "condition": "features.interfaceframework",
            "entries": [
                {
                    "section": "Python3",
                    "entries": [
                        {
                            "type": "python3"
                        },
                        "python3-venv",
                        "system-qface"
                    ]
               },
               "ifcodegen",
               "remoteobjects"
            ]
        },
        {
            "type": "feature",
            "args": "interfaceframework",
            "condition": "!features.interfaceframework"
        }
    ]
}
